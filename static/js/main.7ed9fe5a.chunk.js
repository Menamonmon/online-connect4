(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{130:function(e,t,n){},131:function(e,t,n){},145:function(e,t,n){},147:function(e,t,n){},148:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(39),c=n.n(i),s=(n(79),n(23)),o=n(2),u=n(3),d=n(0),l={currentGame:{},prevGames:[]},j=Object(r.createContext)(l);function f(e){var t=e.children,n=Object(r.useState)(l.currentGame),a=Object(o.a)(n,2),i=a[0],c=a[1],s=Object(r.useState)(l.prevGames),u=Object(o.a)(s,2),f=u[0],m=u[1];return Object(d.jsx)(j.Provider,{value:{currentGame:i,setCurrentGame:c,prevGames:f,setPrevGames:m},children:t})}function m(){return Object(r.useContext)(j)}var b={currentUser:{},invitedUser:{},activeUsers:[]},h=Object(r.createContext)(b);function p(e){var t=e.children,n=Object(r.useState)(b.currentUser),a=Object(o.a)(n,2),i=a[0],c=a[1],s=Object(r.useState)(b.invitedUser),u=Object(o.a)(s,2),l=u[0],j=u[1],f=Object(r.useState)(b.activeUsers),m=Object(o.a)(f,2),p=m[0],v=m[1];return Object(d.jsx)(h.Provider,{value:{currentUser:i,setCurrentUser:c,invitedUser:l,setInvitedUser:j,activeUsers:p,setActiveUsers:v},children:t})}function v(){return Object(r.useContext)(h)}var O=n(6),g=n(7),x=n.n(g),y=n(69),_=n(73),U=n(70);function w(e){var t=e.id,n=I().socket,r={background:"#5ea400",color:"white",border:"none",margin:"10px",fontSize:"1.2rem"};return Object(d.jsxs)("div",{style:{margin:"10px"},children:[Object(d.jsx)("button",{onClick:function(){n.emit("invite accepted"),C(t)},style:Object(O.a)(Object(O.a)({},r),{},{background:"#5ea400"}),children:"Accept"}),Object(d.jsx)("button",{onClick:function(){n.emit("invite rejected"),C(t)},style:Object(O.a)(Object(O.a)({},r),{},{background:"#ec3d3d"}),children:"Reject"})]})}function C(e){g.store.removeNotification(e)}var k=Object(U.io)("https://online-connect4.herokuapp.com",{autoConnect:!1}),S=Object(r.createContext)();function N(e){var t=e.children,n=v(),a=n.setActiveUsers,i=n.setCurrentUser,c=n.setInvitedUser,s=m().setCurrentGame,u=Object(r.useState)(null),l=Object(o.a)(u,2),j=l[0],f=l[1];return Object(r.useEffect)((function(){k.on("auu",(function(e){a(e)})),k.on("notify of invite",(function(e){f(function(e){var t="notification-for:".concat(e.name,"-(").concat(e.id,")-(").concat(1e3*Math.random(),")");C(t);var n={id:t,title:"A new invite has been sent from ".concat(e.name),container:"top-right",type:"info",dismiss:{duration:0,click:!1,touch:!1,showIcon:!1,pauseOnHover:!0},message:Object(d.jsx)(w,{id:t})};return g.store.addNotification(n)}(e))})),k.on("game created",(function(e){var t=e.game,n=e.currentUser,r=e.invitedUser;s(t),i(n),c(r)})),k.on("game has changed",(function(e){s(e)})),k.on("game has ended",(function(){g.store.addNotification({title:"Game Ended",message:"The game was ended because the other player either left the game or logged out of his account",type:"warning",insert:"top",container:"top-right",animationIn:["animate__animated","animate__fadeIn"],animationOut:["animate__animated","animate__fadeOut"],dismiss:{duration:5e3,onScreen:!0}}),s({}),c({})})),k.on("clear game",(function(){s({}),c({})})),k.on("error with saving game",(function(e){var t={title:"Error With Saving Game",message:e,type:"danger",insert:"top",container:"top-right",animationIn:["animate__animated","animate__fadeIn"],animationOut:["animate__animated","animate__fadeOut"],dismiss:{duration:5e3,onScreen:!0}};g.store.addNotification(t)})),k.on("disconnect",(function(){s({}),c({}),i({}),a([])}))}),[a,i,c,s,f]),Object(r.useEffect)((function(){k.off("invite canceled"),k.on("invite canceled",(function(){k.emit("invite rejected"),C(j)}))}),[j]),Object(d.jsx)(S.Provider,{value:{socket:k},children:t})}function I(){return Object(r.useContext)(S)}var G=n(5),A=n.n(G),E=n(16),T=n(71),P=n.n(T).a.create({baseURL:"https://online-connect4.herokuapp.com",timeout:1e4});function F(){return(F=Object(E.a)(A.a.mark((function e(t){var n,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.post("/users/signup",t);case 2:return n=e.sent,e.next=5,n.data;case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(){return(L=Object(E.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.get("/games/user/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(){return(R=Object(E.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.get("/users/active/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(){return(W=Object(E.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.post("/games/create",{player1Id:t,player2Id:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(){return(Y=Object(E.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.get("/types");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var J={signupUser:function(e){return F.apply(this,arguments)},getGameListForUser:function(e){return L.apply(this,arguments)},getActiveUsersList:function(e){return R.apply(this,arguments)},createGame:function(e,t){return W.apply(this,arguments)},getTypes:function(){return Y.apply(this,arguments)}},M=Object(r.createContext)({});function D(e){var t=e.children,n=Object(r.useState)({}),a=Object(o.a)(n,2),i=a[0],c=a[1];return Object(r.useEffect)((function(){function e(){return(e=Object(E.a)(A.a.mark((function e(){var t,n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=null,e.prev=1,e.next=4,J.getTypes();case 4:t=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),console.log(e.t0),e.abrupt("return");case 11:return e.next=13,t.data;case 13:n=e.sent,c(n);case 15:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(d.jsx)(M.Provider,{value:i,children:t})}function z(){return Object(r.useContext)(M)}n(130);function B(e){var t,n=e.state,r=e.index,a=e.onClick,i=e.custom,c=e.width;function s(e){return["white","red","yellow"][e]}if(void 0===i){var o=function(e){return e%6+1},u=o(r),l=((t=r)-(o(t)-1))/6+1;return Object(d.jsx)("div",{className:"game-cell",onClick:function(e){return a(e,u,l)},style:{borderRadius:"50%",backgroundColor:s(n),gridColumn:u,gridRow:l}})}return Object(d.jsx)("div",{className:"game-cell",style:{borderRadius:"50%",backgroundColor:s(n),width:c,height:c}})}function H(e){var t=e.playerColor,n=e.useWarning,r=m(),a=r.currentGame,i=r.setCurrentGame,c=v(),s=c.currentUser,u=c.invitedUser,l=z().cell.EMPTY.toString(),j=I().socket,f=n(),b=Object(o.a)(f,2),h=(b[0],b[1]);function p(e,n){if(a.winner)h("There is already a winner!");else if(null!==t){n--;var r=a.state.split("").map((function(e){return parseInt(e)})),c=function(e){for(var t=function(e){for(var t=[],n=0;n<6;n++)t.push(e+6*n);return t.reverse(),t}(e),n=-1,r=0,i=Object(_.a)(t);r<i.length;r++){var c=i[r];if(a.state.charAt(c)===l){n=c;break}t.shift()}return n}(n);if(c>=0){r[c]=t;var o=r.join(""),d=function(e){for(var t=function(e){return e.every((function(t){return t===e[0]}))},n=[],r=0;r<6;r++){for(var a=[],i=0;i<6;i++)a[i]=e.charAt(6*r+i);n.push(a)}for(var c=0;c<6;c++){for(var s=0;s<3;s++){var o=n[c].slice(s,s+4);if(t(o)&&o[0]!==l)return!0}for(var u=0;u<3;u++){for(var d=[],j=0;j<4;j++)d.push(n[j+u][c]);if(t(d)&&d[0]!==l)return!0}}var f,m=Object(y.a)(function(e){for(var t,n=[],r=e.length,a=e[0].length,i=Math.max(r,a),c=0;c<=2*(i-1);++c){t=[];for(var s=r-1;s>=0;--s){var o=c-s;o>=0&&o<a&&t.push(e[s][o])}t.length>=4&&n.push(t),t=[];for(var u=r-1;u>=0;--u){var d=c-(r-u);d>=0&&d<a&&t.push(e[u][d])}t.length>=4&&n.push(t)}return n}(n));try{for(m.s();!(f=m.n()).done;)for(var b=f.value,h=b.length-4,p=0;p<h;p++){var v=b.slice(p,p+4);if(t(v)&&v[0]!==l)return!0}}catch(O){m.e(O)}finally{m.f()}return!1}(o);i((function(e){var t=Object(O.a)(Object(O.a)({},e),{},{state:o,current_player:u.id});return d&&(t.winner=s.id),j.emit("update game",t),t}))}else h("Please choose another column")}}return Object(d.jsx)("div",{className:"game-container",children:a.state.split("").map((function(e){return parseInt(e)})).map((function(e,t){return Object(d.jsx)(B,{state:e,index:t,onClick:p},"game-cell-".concat(t))}))})}var q=function(e){return 0===Object.keys(e).length};function K(){var e=v(),t=e.currentUser,n=e.invitedUser,a=m().currentGame,i=Object(r.useState)({}),c=Object(o.a)(i,2),s=c[0],u=c[1],l=Object(r.useState)({}),j=Object(o.a)(l,2),f=j[0],b=f.currentUserColor,h=f.invitedUserColor,p=j[1],x=Object(r.useState)(t.id===s.id?"This is your turn":"This is your opponent's turn"),y=Object(o.a)(x,2),_=y[0],U=y[1],w={color:"green",margin:0};return Object(r.useEffect)((function(){if(!(q(a)||q(t)||q(n))){if(a.winner){var e=t.id===a.winner?t:n,r={title:"Winner",message:"".concat(e.name," won this game!!!!!"),type:"success",insert:"top",container:"top-right",animationIn:["animate__animated","animate__fadeIn"],animationOut:["animate__animated","animate__fadeOut"],dismiss:{duration:5e3,onScreen:!0}};g.store.addNotification(r)}var i=a.current_player===t.id?t:n;u(i),a.winner?U("There is a winner already!!"):U(i.id===t.id?"This is your turn":"This is your opponent's turn."),p(function(e,t,n){var r={currentUserColor:null,invitedUserColor:null};if(n.player_1_id===e.id?r.currentUserColor=n.player_1_color:n.player_1_id===t.id&&(r.invitedUserColor=n.player_1_color),n.player_2_id===e.id){if(r.currentUserColor)throw Error("The game does not have distinct user id's for user 1 and user 2");r.currentUserColor=n.player_2_color}else if(n.player_2_id===t.id){if(r.invitedUserColor)throw Error("The game does not have distinct user id's for user 1 and user 2");r.invitedUserColor=n.player_2_color}if(!r.currentUserColor||!r.invitedUserColor||r.currentUserColor===r.invitedUserColor)throw Error("Problem with matching the user colors (".concat(JSON.stringify(r,null,2),")"));return r}(t,n,a))}}),[a,t,n]),q(a)?Object(d.jsx)("h1",{children:"Ending the game because one of the plyers left"}):Object(d.jsxs)("div",{className:"game-page-container",children:[Object(d.jsxs)("div",{className:"game-page-header",style:{textAlign:"left",width:"calc(70vw + 20px)",margin:"20px auto",padding:"0px",maxWidth:"90vh"},children:[Object(d.jsxs)("div",{className:"game-page-title",style:{backgroundColor:"lightgrey",padding:"10px"},children:[Object(d.jsxs)("h3",{style:w,children:["You: ",t.name,Object(d.jsx)("div",{style:{float:"right"},children:Object(d.jsx)(B,{state:b,custom:!0,width:"5vh"})})]}),Object(d.jsx)("br",{}),Object(d.jsxs)("h3",{style:Object(O.a)(Object(O.a)({},w),{},{color:"red"}),children:["Opponent: ",n.name,Object(d.jsx)("div",{style:{float:"right"},children:Object(d.jsx)(B,{state:h,custom:!0,width:"5vh"})})]})]}),Object(d.jsxs)("div",{className:"stats-section",style:{backgroundColor:"lightgrey",padding:10},children:[Object(d.jsx)("h3",{style:Object(O.a)(Object(O.a)({},w),{},{color:"blue"}),children:"Stats:"}),Object(d.jsxs)("h5",{style:{margin:0},children:["Current Player: ",s.name]}),Object(d.jsx)("h5",{style:{margin:0},children:a.winner?"".concat(a.winner===t.id?t.name:n.name," is the winner!!!"):"No Winner Yet :("}),Object(d.jsx)("h5",{style:{margin:0},children:_})]})]}),Object(d.jsx)(H,{useWarning:function(){return[_,U]},playerColor:s.id===t.id?b:null})]})}n(131);function Q(){var e=v().setCurrentUser,t=Object(r.useState)(""),n=Object(o.a)(t,2),a=n[0],i=n[1],c=Object(r.useState)(""),s=Object(o.a)(c,2),u=s[0],l=s[1],j=Object(r.useState)(!1),f=Object(o.a)(j,2),m=f[0],b=f[1],h=I().socket;function p(){return(p=Object(E.a)(A.a.mark((function t(n){var r,i,c;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r={},b(!0),i={title:"Signup Success",message:"You have signup successfully successfully.",type:"success",insert:"top",container:"top-right",animationIn:["animate__animated","animate__fadeIn"],animationOut:["animate__animated","animate__fadeOut"],dismiss:{duration:5e3,onScreen:!0}},c={title:"Signup Failure",message:u,type:"danger",insert:"top",container:"top-right",animationIn:["animate__animated","animate__fadeIn"],animationOut:["animate__animated","animate__fadeOut"],dismiss:{duration:5e3,onScreen:!0}},t.prev=5,t.next=8,J.signupUser({name:a});case 8:r=t.sent,t.next=18;break;case 11:return t.prev=11,t.t0=t.catch(5),t.t0.response&&t.t0.response.data&&t.t0.response.data.msg?l(t.t0.response.data.msg):l("Error with server"),c.message=u||"Error with server",g.store.addNotification(c),b(!1),t.abrupt("return");case 18:e(r),h.auth={user:r},h.connect(),g.store.addNotification(i),b(!1);case 23:case"end":return t.stop()}}),t,null,[[5,11]])})))).apply(this,arguments)}return Object(d.jsxs)("div",{className:"signup-container",children:[Object(d.jsx)("label",{htmlFor:"name",className:"name-label",children:"Name:"}),Object(d.jsx)("br",{}),Object(d.jsx)("input",{type:"text",className:"name-field",placeholder:u||"Type your name here",name:"name",value:a,onChange:function(e){i(e.target.value),l("")}}),Object(d.jsx)("br",{}),Object(d.jsx)("button",{className:"signup-submit-btn",onClick:function(e){return p.apply(this,arguments)},disabled:m,children:"Sign Up"})]})}var V=n(74);function X(e){var t=e.component,n=e.isAuthenticated,r=e.redirectPath,a=Object(V.a)(e,["component","isAuthenticated","redirectPath"]);return Object(d.jsx)(u.b,Object(O.a)(Object(O.a)({},a),{},{render:function(){return n()?Object(d.jsx)(t,{}):Object(d.jsx)(u.a,{to:r})}}))}var Z=function(e,t){var n=Object.keys(t),r=Object.values(t).indexOf(e);return r>=0?n[r].toLowerCase():""};function $(e){var t=e.user,n=t.name,r=t.status,a=t.created_at,i=e.onInvite,c=z().user,s=new Date(a);return Object(d.jsxs)("div",{className:"user-list-item",children:[Object(d.jsx)("h3",{className:"user-name",children:n}),Object(d.jsxs)("h4",{className:"user-status",style:{textTransform:"capitalize"},children:[Z(r,c),Object(d.jsx)("br",{}),"Joined Since"," ","".concat(s.getMonth(),"/").concat(s.getDate(),"/").concat(s.getFullYear())]}),Object(d.jsx)("button",{className:"invite-btn",onClick:i,children:"Invite To Game"})]})}var ee=n(31),te=n.n(ee),ne="Pending Invitation Acceptance",re="Invitation Accepted",ae="Invitation Rejected";function ie(e){var t=e.isOpen,n=e.setOpen,a=v(),i=a.invitedUser,c=a.setInvitedUser,s=I().socket,u=Object(r.useState)(ne),l=Object(o.a)(u,2),j=l[0],f=l[1];return Object(d.jsxs)(te.a,{isOpen:t,onAfterClose:function(){f(ne)},onAfterOpen:function(){s.emit("invite user",i);var e=function e(){setTimeout((function(){n(!1)}),3e3),f(re),s.off("invited user accepted invite",e),s.off("invited user rejected invite",t)},t=function t(){setTimeout((function(){n(!1)}),3e3),c({}),f(ae),s.off("invited user accepted invite",e),s.off("invited user rejected invite",t)};s.on("invited user accepted invite",e),s.on("invited user rejected invite",t)},style:{content:{width:"fit-content",height:"fit-content",margin:"auto"}},children:[Object(d.jsx)("h1",{children:j}),Object(d.jsxs)("div",{children:[Object(d.jsx)("h3",{children:"Invited User Info:"}),Object(d.jsxs)("div",{style:{margin:"20px"},children:[Object(d.jsxs)("strong",{children:["Username: ",i.name]}),Object(d.jsx)("br",{}),Object(d.jsxs)("strong",{children:["Date Joined: ",i.created_at]})]})]}),Object(d.jsx)("img",{alt:"loading animation gif",src:"https://i.pinimg.com/originals/25/ef/28/25ef280441ad6d3a5ccf89960b4e95eb.gif"})]})}function ce(){var e=v(),t=e.activeUsers,n=e.setInvitedUser,a=m().currentGame,i=Object(r.useState)(!1),c=Object(o.a)(i,2),s=c[0],l=c[1],j=Object(u.g)();return Object(r.useEffect)((function(){a&&!q(a)&&j.push("/game")}),[a,j]),Object(d.jsxs)("div",{children:[Object(d.jsx)("li",{className:"users-list",children:t.map((function(e){return Object(d.jsx)($,{user:e,onInvite:function(){n(e),l(!0)}},"user-".concat(e.id))}))}),Object(d.jsx)(ie,{isOpen:s,setOpen:l})]})}function se(){var e=v(),t=e.currentUser,n=e.invitedUser,a=e.activeUsers,i=m().currentGame,c=Object(r.useState)({currentUser:!1,invitedUser:!1,currentGame:!1}),s=Object(o.a)(c,2),l=s[0],j=s[1];return Object(r.useEffect)((function(){var e={currentUser:!q(t),invitedUser:!q(n),currentGame:!q(i)};j(e)}),[t,n,i,a,j]),Object(d.jsxs)(u.d,{children:[Object(d.jsx)(X,{exact:!0,strict:!0,path:"/",isAuthenticated:function(){return!1},redirectPath:"/signup",component:function(){return Object(d.jsx)(d.Fragment,{})}}),Object(d.jsx)(X,{exact:!0,strict:!0,path:"/signup",isAuthenticated:function(){return!l.currentUser},redirectPath:"/users-list",component:Q}),Object(d.jsx)(X,{exact:!0,strict:!0,path:"/users-list",isAuthenticated:function(){return l.currentUser},redirectPath:"/signup",component:ce}),Object(d.jsx)(X,{exact:!0,strict:!0,path:"/game",isAuthenticated:function(){return l.currentGame&&l.currentUser&&l.invitedUser},redirectPath:"/signup",component:K})]})}n(145),n(146);function oe(){var e=I().socket,t=m().currentGame;return Object(d.jsx)("button",{onClick:function(){return e.emit("end game",t)},children:"Leave Game"})}function ue(){var e=I().socket;return Object(d.jsx)("button",{onClick:function(){e.disconnect(),g.store.addNotification({title:"Logout",message:"You have been logged out successfully.",type:"success",insert:"top",container:"top-right",animationIn:["animate__animated","animate__fadeIn"],animationOut:["animate__animated","animate__fadeOut"],dismiss:{duration:1e3,onScreen:!0}})},className:"logout-btn",children:"Logout"})}n(147);function de(){var e=v().currentUser,t=m().currentGame,n=!q(e),r=!q(t);return Object(d.jsx)("nav",{children:Object(d.jsxs)("ul",{className:"nav-items",children:[n?Object(d.jsx)("li",{className:"nav-item",children:Object(d.jsx)(ue,{})},"logout"):Object(d.jsx)(d.Fragment,{}),r?Object(d.jsx)("li",{className:"nav-item",children:Object(d.jsx)(oe,{})},"leave-game"):Object(d.jsx)(d.Fragment,{})]})})}var le=function(){var e=Object(r.useRef)(null);return Object(r.useEffect)((function(){te.a.setAppElement(e.current)})),Object(d.jsx)("div",{className:"App",ref:e,children:Object(d.jsx)(D,{children:Object(d.jsx)(p,{children:Object(d.jsx)(f,{children:Object(d.jsxs)(N,{children:[Object(d.jsx)(x.a,{}),Object(d.jsx)(de,{}),Object(d.jsx)(s.a,{children:Object(d.jsx)(se,{})})]})})})})})};c.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(le,{})}),document.getElementById("root"))},79:function(e,t,n){}},[[148,1,2]]]);
//# sourceMappingURL=main.7ed9fe5a.chunk.js.map